name: Clone Test

on:
  workflow_dispatch:

jobs:
  clone-repo:
    runs-on: ubuntu-latest

    steps:
      - name: Set up SSH agent with deploy key
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.DEPLOY_KEY }}" > ~/.ssh/temp_deploy_key
          chmod 600 ~/.ssh/temp_deploy_key

          eval "$(ssh-agent -s)"
          ssh-add ~/.ssh/temp_deploy_key

          ssh-keyscan github.com >> ~/.ssh/known_hosts
        env:
          SSH_AUTH_SOCK: /tmp/ssh-auth.sock

      - name: Clone target repository
        env:
          SSH_AUTH_SOCK: /tmp/ssh-auth.sock
        run: |
          git clone git@github.com:Dmitrii-Zavalin-Deployments/engineering_simulations_pipeline_domain_grid_sred.git
